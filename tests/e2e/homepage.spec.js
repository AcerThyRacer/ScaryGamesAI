/** * Homepage E2E Tests * Phase 1: Testing Infrastructure Expansion */ const { test, expect } = require('@playwright/test'); test.describe('Homepage', () => { test.beforeEach(async ({ page }) => { await page.goto('/'); }); test('should load homepage successfully', async ({ page }) => { // Check title await expect(page).toHaveTitle(/ScaryGamesAI|Horror Gaming/i); // Check main heading const heroTitle = page.locator('h1, .hero-title').first(); await expect(heroTitle).toBeVisible(); }); test('should display game cards', async ({ page }) => { // Wait for games to load await page.waitForSelector('.game-card', { timeout: 10000 }); // Check game cards exist const gameCards = page.locator('.game-card'); const count = await gameCards.count(); expect(count).toBeGreaterThan(0); // Check first game card has required elements const firstCard = gameCards.first(); await expect(firstCard.locator('.game-card-title')).toBeVisible(); await expect(firstCard.locator('.play-btn')).toBeVisible(); }); test('should filter games by category', async ({ page }) => { // Wait for games to load await page.waitForSelector('.game-card', { timeout: 10000 }); // Click 3D filter const filter3d = page.locator('.filter-btn[data-filter="3d"]'); if (await filter3d.isVisible()) { await filter3d.click(); // Wait for filter to apply await page.waitForTimeout(500); // Check all visible cards have 3D tag const visibleCards = page.locator('.game-card:visible'); const count = await visibleCards.count(); if (count > 0) { const firstCard = visibleCards.first(); const tags = firstCard.locator('.tag-3d'); await expect(tags.first()).toBeVisible(); } } }); test('should have working navigation', async ({ page }) => { // Check navigation links const navLinks = page.locator('nav a, .nav-link'); const count = await navLinks.count(); expect(count).toBeGreaterThan(0); // Test games link const gamesLink = page.locator('a[href*="games.html"]'); if (await gamesLink.isVisible()) { await gamesLink.click(); await expect(page).toHaveURL(/games\.html/); } }); test('should load service worker', async ({ page }) => { // Check if service worker is registered const swRegistered = await page.evaluate(() => { return navigator.serviceWorker.getRegistration() .then(reg => reg !== undefined); }); expect(swRegistered).toBe(true); }); test('should have responsive design on mobile', async ({ page, isMobile }) => { if (!isMobile) return; // Check mobile menu or navigation const mobileNav = page.locator('.mobile-nav, .hamburger-menu, nav'); await expect(mobileNav.first()).toBeVisible(); // Check game cards are stacked vertically const gameCard = page.locator('.game-card').first(); const box = await gameCard.boundingBox(); if (box) { // On mobile, cards should be narrower expect(box.width).toBeLessThan(500); } }); test('should show subscription modal for locked games', async ({ page }) => { // Wait for games to load await page.waitForSelector('.game-card', { timeout: 10000 }); // Find a locked game card const lockedCard = page.locator('.game-card.game-card-locked').first(); if (await lockedCard.isVisible()) { // Click the upgrade button const upgradeBtn = lockedCard.locator('.game-upgrade-btn'); await upgradeBtn.click(); // Check modal appears const modal = page.locator('#upgrade-modal, .upgrade-modal'); await expect(modal).toBeVisible(); } }); test('should have accessible elements', async ({ page }) => { // Check for skip link const skipLink = page.locator('[href="#main"], .skip-link'); // Check for proper heading hierarchy const h1 = page.locator('h1'); await expect(h1.first()).toBeVisible(); // Check for alt text on images const images = page.locator('img'); const count = await images.count(); for (let i = 0; i < Math.min(count, 5); i++) { const img = images.nth(i); const alt = await img.getAttribute('alt'); expect(alt).not.toBe(null); } }); test('should handle theme preferences', async ({ page }) => { // Check for theme-related elements const prefersDark = await page.evaluate(() => { return window.matchMedia('(prefers-color-scheme: dark)').matches; }); // Check for reduced motion preference const prefersReducedMotion = await page.evaluate(() => { return window.matchMedia('(prefers-reduced-motion: reduce)').matches; }); // If reduced motion, videos should not autoplay if (prefersReducedMotion) { const videos = page.locator('video'); const count = await videos.count(); for (let i = 0; i < count; i++) { const video = videos.nth(i); const paused = await video.evaluate(v => v.paused); expect(paused).toBe(true); } } }); });