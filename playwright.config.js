/** * Playwright E2E Testing Configuration * Phase 1: Testing Infrastructure Expansion * * Features: * - Cross-browser testing (Chrome, Firefox, Safari, Edge) * - Mobile viewport testing * - Visual regression testing * - Screenshot comparisons * - Trace viewing for debugging */ const { defineConfig, devices } = require('@playwright/test'); module.exports = defineConfig({ // Test directory testDir: './tests/e2e', // Fully parallel tests fullyParallel: true, // Fail build on CI if you accidentally left test.only in source code forbidOnly: !!process.env.CI, // Retry on CI only retries: process.env.CI ? 2 : 0, // Opt out of parallel tests on CI workers: process.env.CI ? 1 : undefined, // Reporter configuration reporter: [ ['html', { outputFolder: 'playwright-report', open: 'never' }], ['json', { outputFile: 'test-results/results.json' }], ['list'], ], // Shared settings for all projects use: { // Base URL baseURL: 'http://localhost:9999', // Collect trace on failure trace: 'on-first-retry', // Screenshot on failure screenshot: 'only-on-failure', // Video on failure video: 'retain-on-failure', // Action timeout actionTimeout: 10000, // Navigation timeout navigationTimeout: 30000, // Browser context contextOptions: { ignoreHTTPSErrors: true, }, }, // Configure projects for major browsers projects: [ { name: 'chromium', use: { ...devices['Desktop Chrome'], }, }, { name: 'firefox', use: { ...devices['Desktop Firefox'], }, }, { name: 'webkit', use: { ...devices['Desktop Safari'], }, }, // Mobile testing { name: 'Mobile Chrome', use: { ...devices['Pixel 5'], }, }, { name: 'Mobile Safari', use: { ...devices['iPhone 12'], }, }, // Tablet testing { name: 'iPad', use: { ...devices['iPad Pro 11'], }, }, // Visual regression project { name: 'visual-regression', testMatch: /.*visual.*\.spec\.js/, use: { ...devices['Desktop Chrome'], viewport: { width: 1280, height: 720 }, }, }, ], // Run local dev server before tests webServer: { command: 'node server.js', url: 'http://localhost:9999', reuseExistingServer: !process.env.CI, timeout: 120000, }, // Test timeout timeout: 30000, // Expect timeout expect: { timeout: 5000, }, // Output directory outputDir: 'test-results/', // Snapshot path template snapshotPathTemplate: '{testDir}/__screenshots__/{testFilePath}/{arg}{ext}', });