<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <title>Backrooms: Pac-Man ‚Äî ScaryGamesAI</title>
    <meta name="description" content="Escape a haunted maze where a giant Pac-Man hunts you through eerie backrooms corridors.">
    <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1">
    <link rel="canonical" href="https://scarygames.ai/games/backrooms-pacman/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="ScaryGamesAI">
    <meta property="og:title" content="Backrooms: Pac-Man ‚Äî ScaryGamesAI">
    <meta property="og:description" content="Escape a haunted maze where a giant Pac-Man hunts you through eerie backrooms corridors.">
    <meta property="og:url" content="https://scarygames.ai/games/backrooms-pacman/">
    <meta property="og:image" content="https://scarygames.ai/assets/og-game-fallback.svg?game=backrooms-pacman">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Backrooms: Pac-Man ‚Äî ScaryGamesAI">
    <meta name="twitter:description" content="Escape a haunted maze where a giant Pac-Man hunts you through eerie backrooms corridors.">
    <meta name="twitter:image" content="https://scarygames.ai/assets/og-game-fallback.svg?game=backrooms-pacman">
    <link rel="manifest" href="/manifest.json">
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "VideoGame",
          "name": "Backrooms: Pac-Man",
          "description": "Escape a haunted maze where a giant Pac-Man hunts you through eerie backrooms corridors.",
          "genre": [
            "Horror",
            "Maze",
            "Survival"
          ],
          "applicationCategory": "Game",
          "operatingSystem": "Web Browser",
          "url": "https://scarygames.ai/games/backrooms-pacman/",
          "image": [
            "https://scarygames.ai/assets/og-game-fallback.svg?game=backrooms-pacman"
          ],
          "publisher": {
            "@type": "Organization",
            "name": "ScaryGamesAI",
            "url": "https://scarygames.ai/"
          },
          "isPartOf": {
            "@type": "WebSite",
            "name": "ScaryGamesAI",
            "url": "https://scarygames.ai/"
          }
        }
    </script>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/game-responsive.css">
    <link rel="stylesheet" href="/css/mobile-controls.css">
    <link rel="stylesheet" href="/css/game-container.css">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
        }

        #game-canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
    </style>
    <link rel="stylesheet" href="/css/mobile-enhancements.css" id="mc-enhance-css">
</head>

<body>
    <a href="#game-container" class="sr-only skip-link">Skip to game</a>
    <main class="game-page" role="main">
        <a href="/games.html" class="back-link" id="back-link" aria-label="Return to games list">‚Üê Back to Games</a>

        <!-- Start Screen -->
        <div class="start-screen" id="start-screen" role="dialog" aria-modal="false" aria-labelledby="start-title">
            <h1 id="start-title">Backrooms: Pac-Man</h1>
            <p class="game-desc">You're trapped in the backrooms. A giant Pac-Man is hunting you. Collect all the
                pellets to find your way out.</p>

            <!-- Difficulty Selector -->
            <div class="difficulty-selector" id="difficulty-selector" style="margin: 20px 0; text-align: center;">
                <label for="difficulty-select" style="color: #aaa; font-size: 0.9rem; display: block; margin-bottom: 8px;">SELECT DIFFICULTY</label>
                <select id="difficulty-select" style="
                    background: rgba(0,0,0,0.7);
                    color: #fff;
                    border: 1px solid #555;
                    padding: 10px 20px;
                    font-size: 1rem;
                    border-radius: 4px;
                    cursor: pointer;
                    min-width: 200px;
                ">
                    <option value="novice">Novice (Easy visibility)</option>
                    <option value="standard" selected>Standard (Normal)</option>
                    <option value="hard">Hard (Thicker fog)</option>
                    <option value="nightmare">Nightmare (Very dark)</option>
                    <option value="impossible">Impossible (Extreme)</option>
                </select>
                <div id="difficulty-description" style="color: #888; font-size: 0.8rem; margin-top: 8px; min-height: 20px;">
                    Standard difficulty with normal fog density
                </div>
            </div>

            <!-- Level Selector -->
            <div class="level-selector" id="level-selector" style="margin: 20px 0; text-align: center;">
                <label for="level-select" style="color: #aaa; font-size: 0.9rem; display: block; margin-bottom: 8px;">SELECT BACKROOMS LEVEL</label>
                <select id="level-select" style="
                    background: rgba(0,0,0,0.7);
                    color: #fff;
                    border: 1px solid #555;
                    padding: 10px 20px;
                    font-size: 1rem;
                    border-radius: 4px;
                    cursor: pointer;
                    min-width: 200px;
                ">
<option value="yellow" selected>Yellow Backrooms (Standard)</option>
<option value="mono">Mono-Yellow (Harder)</option>
<option value="infinite">Infinite (Nightmare)</option>
<option value="flooded">Flooded (Dark & Wet)</option>
<option value="construction">Construction (Industrial)</option>
<option value="sewers" style="color:#ff4444;">‚ö†Ô∏è THE SEWERS (TERRIFYING)</option>
</select>
<div id="level-description" style="color: #888; font-size: 0.8rem; margin-top: 8px; min-height: 20px;">
The classic yellow wallpaper backrooms
</div>
            </div>

            <button class="start-btn" id="start-btn" aria-label="Start Backrooms Pac-Man game">START GAME</button>
        </div>

        <!-- Controls Overlay -->
        <div class="controls-overlay" id="controls-overlay" style="display:none;" role="dialog" aria-modal="true" aria-labelledby="controls-title">
            <div class="controls-content">
                <h2 id="controls-title">Controls</h2>
                <div class="control-item"><span class="control-key">W A S D</span> Move</div>
                <div class="control-item"><span class="control-key">Mouse</span> Look Around</div>
                <div class="control-item"><span class="control-key">Shift</span> Run</div>
                <div class="control-item"><span class="control-key">1 2 3 4 5</span> Use gathered abilities</div>
                <div class="control-item"><span class="control-key">ESC</span> Pause / Release Mouse</div>
                <p class="controls-start-hint">Starting in a moment...</p>
            </div>
        </div>

        <!-- Game Container -->
        <div class="game-container" id="game-container">
            <canvas id="game-canvas" aria-label="Backrooms Pac-Man game canvas - use WASD to move, mouse to look around"></canvas>

            <!-- HUD -->
            <div class="game-hud" id="game-hud" style="display:none;">
                <div class="hud-score" id="hud-score">Pellets: 0 / 0</div>
                <div id="hud-pacman-count"
                    style="color:#ff4444;font-family:Creepster,cursive;font-size:1.2rem;text-shadow:0 0 10px #ff0000;margin-left:16px;">
                </div>
                <div id="stamina-bar-container"
                    style="display:none;position:fixed;bottom:20px;left:50%;transform:translateX(-50%);width:200px;z-index:70;">
                    <div style="color:#aaa;font-size:0.7rem;font-family:monospace;text-align:center;margin-bottom:4px;">
                        SPRINT</div>
                    <div
                        style="background:rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.15);border-radius:4px;height:8px;overflow:hidden;">
                        <div id="stamina-bar-fill"
                            style="height:100%;width:100%;background:#00cc66;transition:width 0.1s,background 0.3s;border-radius:4px;">
                        </div>
                    </div>
                </div>
                <div class="hud-controls">
<button class="hud-btn" id="audio-btn" onclick="HorrorAudioEnhanced.toggleSettings()">üîä Audio</button>
      <button class="hud-btn" id="phase8-audio-btn" onclick="togglePhase8AudioSettings()">üéõÔ∏è Phase 8 Audio</button>
      <button class="hud-btn" id="fullscreen-btn">‚õ∂ Fullscreen</button>
    </div>
            </div>

<!-- Minimap -->
    <div class="minimap-container" id="minimap-container" style="display:none;">
      <canvas id="minimap-canvas" width="180" height="180"></canvas>
    </div>

    <!-- PHASE 8: Audio Settings Panel -->
    <div id="phase8-audio-panel" class="phase8-audio-panel" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(10,10,20,0.98);border:1px solid rgba(204,17,34,0.3);border-radius:16px;padding:30px;z-index:1000001;min-width:450px;max-width:90vw;box-shadow:0 0 40px rgba(204,17,34,0.2);backdrop-filter:blur(20px);">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid rgba(255,255,255,0.1);">
        <h2 style="margin:0;color:#cc1122;font-size:1.5rem;font-family:'Creepster',cursive;">PHASE 8 AUDIO SETTINGS</h2>
        <button onclick="togglePhase8AudioSettings()" style="background:none;border:none;color:#888;font-size:1.5rem;cursor:pointer;padding:0;line-height:1;">&times;</button>
      </div>

      <div style="max-height:60vh;overflow-y:auto;">
        <!-- 3D Audio Settings -->
        <div style="margin-bottom:24px;">
          <h3 style="color:#fff;margin:0 0 12px 0;font-size:1rem;text-transform:uppercase;letter-spacing:1px;">3D Audio</h3>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">HRTF Spatial Audio</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-hrtf" checked style="display:none;" onchange="updatePhase8AudioSetting('hrtf', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Sound Occlusion</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-occlusion" checked style="display:none;" onchange="updatePhase8AudioSetting('occlusion', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Doppler Effect</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-doppler" checked style="display:none;" onchange="updatePhase8AudioSetting('doppler', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
        </div>

        <!-- Dynamic Soundtrack -->
        <div style="margin-bottom:24px;">
          <h3 style="color:#fff;margin:0 0 12px 0;font-size:1rem;text-transform:uppercase;letter-spacing:1px;">Dynamic Soundtrack</h3>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Adaptive Music</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-adaptive" checked style="display:none;" onchange="updatePhase8AudioSetting('adaptive', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Leitmotifs</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-leitmotifs" checked style="display:none;" onchange="updatePhase8AudioSetting('leitmotifs', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Silence Mechanics</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-silence" checked style="display:none;" onchange="updatePhase8AudioSetting('silence', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
        </div>

        <!-- Procedural Audio -->
        <div style="margin-bottom:24px;">
          <h3 style="color:#fff;margin:0 0 12px 0;font-size:1rem;text-transform:uppercase;letter-spacing:1px;">Procedural Audio</h3>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Voice Synthesis</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-voice" checked style="display:none;" onchange="updatePhase8AudioSetting('voice', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">Enhanced Footsteps</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-footsteps" checked style="display:none;" onchange="updatePhase8AudioSetting('footsteps', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
        </div>

        <!-- Binaural Audio -->
        <div style="margin-bottom:24px;">
          <h3 style="color:#fff;margin:0 0 12px 0;font-size:1rem;text-transform:uppercase;letter-spacing:1px;">Binaural Audio</h3>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <span style="color:#aaa;font-size:0.9rem;">ASMR Mode</span>
            <label class="phase8-toggle" style="width:48px;height:26px;background:rgba(204,17,34,0.3);border-radius:13px;position:relative;cursor:pointer;">
              <input type="checkbox" id="phase8-asmr" style="display:none;" onchange="updatePhase8AudioSetting('asmr', this.checked)">
              <span class="phase8-toggle-slider" style="position:absolute;width:20px;height:20px;background:#fff;border-radius:50%;top:3px;left:3px;transition:transform 0.3s;"></span>
            </label>
          </div>
          <div style="margin-top:16px;">
            <button onclick="startHRTFCalibration()" style="width:100%;padding:12px;background:rgba(204,17,34,0.2);border:1px solid rgba(204,17,34,0.4);border-radius:8px;color:#cc1122;cursor:pointer;font-size:0.9rem;transition:all 0.3s;" onmouseover="this.style.background='rgba(204,17,34,0.3)'" onmouseout="this.style.background='rgba(204,17,34,0.2)'">
              üéß Start HRTF Calibration
            </button>
            <p style="color:#666;font-size:0.8rem;margin-top:8px;text-align:center;">Calibrate audio to your ear shape for enhanced 3D sound</p>
          </div>
        </div>
      </div>

      <div style="margin-top:20px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.1);text-align:center;">
        <button onclick="resetPhase8AudioDefaults()" style="padding:8px 20px;background:rgba(255,255,255,0.1);border:none;border-radius:6px;color:#aaa;cursor:pointer;font-size:0.85rem;">Reset to Defaults</button>
      </div>
    </div>

    <style>
      .phase8-toggle-slider {
        transition: transform 0.3s;
      }
      input:checked + .phase8-toggle-slider {
        transform: translateX(22px);
      }
      input:checked ~ .phase8-toggle {
        background: rgba(204,17,34,0.6) !important;
      }
    </style>
  </div>

        <!-- Game Over -->
        <div class="game-end-screen game-over" id="game-over-screen" style="display:none;" role="alertdialog" aria-modal="true" aria-labelledby="gameover-title" aria-describedby="gameover-desc">
            <h1 id="gameover-title">GAME OVER</h1>
            <p id="gameover-desc">Pac-Man consumed you...</p>
            <button class="play-btn" id="gameover-retry-btn" aria-label="Try again">‚ñ∂ Try Again</button>
            <a href="/games.html" style="display:block;margin-top:16px;color:#888;">‚Üê Back to Games</a>
        </div>

        <!-- Win Screen -->
        <div class="game-end-screen game-win" id="game-win-screen" style="display:none;" role="alertdialog" aria-modal="true" aria-labelledby="win-title" aria-describedby="win-desc">
            <h1 id="win-title">YOU ESCAPED!</h1>
            <p id="win-desc">All pellets collected. You found the way out!</p>
            <button class="play-btn" id="win-retry-btn" aria-label="Play again">‚ñ∂ Play Again</button>
            <a href="/games.html" style="display:block;margin-top:16px;color:#888;">‚Üê Back to Games</a>
        </div>
    </main>

    <!-- Three.js from CDN - Consider self-hosting for production with SRI hash -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" crossorigin="anonymous"></script>
    <script src="/js/visual-enhancements.js"></script>
    <script src="/js/audio-enhanced.js"></script>
    <script src="/js/ai-system.js"></script>
    <script src="/js/game-utils.js"></script>
    <script src="/js/state-bus.js"></script>
    <script src="/js/audio.js"></script>
    <script src="/js/quality-enhancer.js"></script>
    <script src="/js/visual-utils.js"></script>
    <script src="/js/cinematic-overlay.js"></script>
    <script src="/js/quality-fx.js"></script>
    <script src="/js/quality-settings.js"></script>
    <script src="/js/mobile-controls.js"></script>
    <script src="/js/mobile-game-bindings.js"></script>
    <script src="/js/mobile-tutorial.js"></script>
    <script src="/js/mobile-settings.js"></script>
    <script src="/js/device-testing.js"></script>
    
    <!-- Mobile Support -->
    <script src="/js/mobile-setup.js" id="mobile-setup-js"></script>
    <script src="/js/mobile-controls.js" id="mc-js"></script>
    <script src="/js/mobile-game-bindings.js" id="mc-bindings-js"></script>
    <script src="/js/mobile-universal-init.js" id="mc-init-js"></script>
    <script src="/js/mobile-patcher.js" id="mc-patcher-js"></script>
    <!-- End Mobile Support -->
    
    <!-- Accessibility, Memory & Performance -->
    <script src="/js/accessibility-manager.js" id="a11y-js"></script>
    <script src="/js/memory-manager.js" id="mem-js"></script>
    <script src="/js/performance-optimizer.js" id="perf-js"></script>
    <!-- End Core Systems -->
    
<!-- Unified Game Container & Cheats System -->
<script src="/js/cheats-mods-system.js"></script>
<script src="/js/unified-game-container.js"></script>

<!-- Phase 1: Advanced Visual Systems -->
<script src="shaders/wallDistortion.vert" type="x-shader/x-vertex" id="wall-distortion-vert"></script>
<script src="shaders/wallDistortion.frag" type="x-shader/x-fragment" id="wall-distortion-frag"></script>
<script src="shaders/volumetricLight.vert" type="x-shader/x-vertex" id="volumetric-light-vert"></script>
<script src="shaders/volumetricLight.frag" type="x-shader/x-fragment" id="volumetric-light-frag"></script>
<script src="shaders/shadowMap.vert" type="x-shader/x-vertex" id="shadow-map-vert"></script>
<script src="shaders/shadowMap.frag" type="x-shader/x-fragment" id="shadow-map-frag"></script>
<script src="advanced-lighting.js"></script>
<script src="decay-system.js"></script>
<script src="dynamic-environment.js"></script>

<!-- Phase 2: AI Systems -->
<script src="multi-agent-pacman.js"></script>
<script src="ai-learner.js"></script>
<script src="enemy-variants.js"></script>
<script src="threat-assessment.js"></script>
<script src="phase2-ai-integration.js"></script>

<!-- Phase 3: Procedural Content -->
<script src="procedural-maze.js"></script>
<script src="biome-system.js"></script>
<script src="roguelike-mode.js"></script>
<!-- PHASE 3 ENHANCEMENTS -->
<script src="wave-function-collapse.js"></script>
<script src="biome-system-enhanced.js"></script>
<script src="roguelike-mode-enhanced.js"></script>

<!-- Phase 4: Psychological Horror -->
<script src="sanity-system.js"></script>
<script src="jumpscare-system.js"></script>
<script src="stress-system.js"></script>
<script src="horror-director.js"></script>
<!-- PHASE 4 ENHANCEMENTS -->
<script src="hallucination-system.js"></script>

<!-- Phase 5: Multiplayer & Social -->
<script src="multiplayer.js"></script>
<script src="ghost-system.js"></script>
<script src="voice-chat.js"></script>

<!-- Phase 6: Abilities & Combat -->
<script src="expanded-abilities.js"></script>
<script src="crafting-system.js"></script>
<script src="defensive-mechanics.js"></script>
<script src="skill-trees.js"></script>

<!-- Phase 7: Story & Progression -->
<script src="campaign-mode.js"></script>
<script src="story-elements.js"></script>
<script src="quest-system.js"></script>
<script src="character-progression.js"></script>

<!-- Phase 8: Audio Revolution -->
<script src="advanced-3d-audio.js"></script>
<script src="dynamic-soundtrack.js"></script>
<script src="procedural-audio.js"></script>
<script src="binaural-audio.js"></script>
<script src="phase8-audio-integration.js"></script>

<!-- PHASE 3 & 4 INTEGRATION -->
<script src="phase3-4-integration.js"></script>

<!-- PHASE 8: Audio Settings Functions -->
<script>
// Phase 8 Audio Settings Panel
var phase8AudioSettings = {
  hrtf: true,
  occlusion: true,
  doppler: true,
  adaptive: true,
  leitmotifs: true,
  silence: true,
  voice: true,
  footsteps: true,
  asmr: false
};

function togglePhase8AudioSettings() {
  var panel = document.getElementById('phase8-audio-panel');
  if (panel) {
    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
  }
}

function updatePhase8AudioSetting(setting, value) {
  phase8AudioSettings[setting] = value;

  // Apply settings to audio systems
  if (setting === 'hrtf' && typeof Advanced3DAudio !== 'undefined') {
    Advanced3DAudio.config.hrtfEnabled = value;
  } else if (setting === 'occlusion' && typeof Advanced3DAudio !== 'undefined') {
    Advanced3DAudio.config.occlusionEnabled = value;
  } else if (setting === 'doppler' && typeof Advanced3DAudio !== 'undefined') {
    Advanced3DAudio.config.dopplerEnabled = value;
  } else if (setting === 'adaptive' && typeof DynamicSoundtrack !== 'undefined') {
    DynamicSoundtrack.config.adaptiveMusic = value;
  } else if (setting === 'leitmotifs' && typeof DynamicSoundtrack !== 'undefined') {
    DynamicSoundtrack.config.leitmotifsEnabled = value;
  } else if (setting === 'silence' && typeof DynamicSoundtrack !== 'undefined') {
    DynamicSoundtrack.config.silenceEnabled = value;
  } else if (setting === 'voice' && typeof ProceduralAudio !== 'undefined') {
    ProceduralAudio.setVoiceSynth({ enabled: value });
  } else if (setting === 'asmr' && typeof BinauralAudio !== 'undefined') {
    BinauralAudio.enableASMRMode(value);
  }

  console.log('[Phase8Audio] Setting updated:', setting, '=', value);

  // Save to localStorage
  localStorage.setItem('phase8_audio_settings', JSON.stringify(phase8AudioSettings));
}

function loadPhase8AudioSettings() {
  var saved = localStorage.getItem('phase8_audio_settings');
  if (saved) {
    try {
      var loaded = JSON.parse(saved);
      phase8AudioSettings = Object.assign(phase8AudioSettings, loaded);

      // Update UI
      for (var key in phase8AudioSettings) {
        var checkbox = document.getElementById('phase8-' + key);
        if (checkbox) {
          checkbox.checked = phase8AudioSettings[key];
        }
      }
    } catch (e) {
      console.error('[Phase8Audio] Failed to load settings:', e);
    }
  }
}

function resetPhase8AudioDefaults() {
  phase8AudioSettings = {
    hrtf: true,
    occlusion: true,
    doppler: true,
    adaptive: true,
    leitmotifs: true,
    silence: true,
    voice: true,
    footsteps: true,
    asmr: false
  };

  // Update UI
  for (var key in phase8AudioSettings) {
    var checkbox = document.getElementById('phase8-' + key);
    if (checkbox) {
      checkbox.checked = phase8AudioSettings[key];
      updatePhase8AudioSetting(key, phase8AudioSettings[key]);
    }
  }

  localStorage.removeItem('phase8_audio_settings');
  console.log('[Phase8Audio] Settings reset to defaults');
}

function startHRTFCalibration() {
  if (typeof BinauralAudio !== 'undefined' && BinauralAudio.calibrateHRTF) {
    BinauralAudio.calibrateHRTF();
  } else {
    alert('Binaural audio system not available. Make sure all audio modules are loaded.');
  }
}

// Load settings on page load
window.addEventListener('DOMContentLoaded', function() {
  loadPhase8AudioSettings();
});
</script>

<script src="backrooms-pacman.js"></script>
</body>

</html>
